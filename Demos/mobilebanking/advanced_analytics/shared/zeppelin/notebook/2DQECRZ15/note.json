{
  "paragraphs": [
    {
      "title": "Merchant Categories",
      "text": "%md\n\nThe merchant category is an important feature for a fraud prediction model because people tend to follow the same expenditure pattern on each category.\n\nFor instance, it is perfectly common to spend US$10 or even US$200 on Food. But it is uncommon to spend US$1000 (to be very explicit). On the other hand,\nit is very common for people to spend a lot on healthcare or hotel services.\n\nCategories are stored on the *IRISDemo.BC_MERCH_CATEGORY* table. The column *BC_MERCH_CAT_CODE* is an integer that is used as a feature of our model. \n\nLet\u0027s see what are the categories we have:",
      "user": "anonymous",
      "dateUpdated": "Sep 13, 2018 7:47:32 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "editorMode": "ace/mode/markdown",
        "title": true,
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eThe merchant category is an important feature for a fraud prediction model because people tend to follow the same expenditure pattern on each category.\u003c/p\u003e\n\u003cp\u003eFor instance, it is perfectly common to spend US$10 or even US$200 on Food. But it is uncommon to spend US$1000 (to be very explicit). On the other hand,\u003cbr/\u003eit is very common for people to spend a lot on healthcare or hotel services.\u003c/p\u003e\n\u003cp\u003eCategories are stored on the \u003cem\u003eIRISDemo.BC_MERCH_CATEGORY\u003c/em\u003e table. The column \u003cem\u003eBC_MERCH_CAT_CODE\u003c/em\u003e is an integer that is used as a feature of our model. \u003c/p\u003e\n\u003cp\u003eLet\u0026rsquo;s see what are the categories we have:\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1536867705877_-382134174",
      "id": "20180913-194145_1724792194",
      "dateCreated": "Sep 13, 2018 7:41:45 PM",
      "dateStarted": "Sep 13, 2018 7:47:32 PM",
      "dateFinished": "Sep 13, 2018 7:47:32 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Merchant Categories",
      "text": "%irisjdbc\n\nselect * from IRISDemo.BC_MERCH_CATEGORY",
      "user": "anonymous",
      "dateUpdated": "Sep 13, 2018 7:45:27 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/sql",
        "title": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "ID\tBC_MERCH_CAT_CODE\tBC_MERCH_CAT_DESC\n1\t12\tTransportation\n2\t4\tHealth\n3\t9\tOtherservices\n4\t3\tFood\n5\t6\tHotelservices\n6\t0\tBarsandrestaurants\n7\t11\tTech\n8\t10\tSportsandtoys\n9\t14\tWellnessandbeauty\n10\t7\tHyper\n11\t2\tFashion\n12\t5\tHome\n13\t1\tContents\n14\t13\tTravel\n15\t8\tLeisure\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1535411946828_973439587",
      "id": "20180827-231906_879263362",
      "dateCreated": "Aug 27, 2018 11:19:06 PM",
      "dateStarted": "Aug 30, 2018 3:39:26 PM",
      "dateFinished": "Aug 30, 2018 3:39:28 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Merchants",
      "text": "%md\n\nMerchants are also important for our model. Take the *Food* category for instance. Food on a merchant can be typically more expensive than on another merchant that also is under category food.\n\nSo, both the specific merchant AND the merchant\u0027s category become important features for our model.\n\nMerchants are on table *IRISDemo.BC_MERCH_ACCOUNT*. The next query will give you a list of merchants, their feature code and their category feature code:",
      "user": "anonymous",
      "dateUpdated": "Sep 13, 2018 7:54:15 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "editorMode": "ace/mode/markdown",
        "title": true,
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eMerchants are also important for our model. Take the \u003cem\u003eFood\u003c/em\u003e category for instance. Food on a merchant can be typically more expensive than on another merchant that also is under category food.\u003c/p\u003e\n\u003cp\u003eSo, both the specific merchant AND the merchant\u0026rsquo;s category become important features for our model.\u003c/p\u003e\n\u003cp\u003eMerchants are on table \u003cem\u003eIRISDemo.BC_MERCH_ACCOUNT\u003c/em\u003e. The next query will give you a list of merchants, their feature code and their category feature code:\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1536868056884_1527281028",
      "id": "20180913-194736_14694211",
      "dateCreated": "Sep 13, 2018 7:47:36 PM",
      "dateStarted": "Sep 13, 2018 7:54:15 PM",
      "dateFinished": "Sep 13, 2018 7:54:15 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%irisjdbc\n\nselect BC_ACC_NUMBER, BC_MERCH_CODE, BC_MERCH_CATEGORY-\u003eBC_MERCH_CAT_DESC, BC_MERCH_CATEGORY-\u003eBC_MERCH_CAT_CODE from IRISDemo.BC_MERCH_ACCOUNT",
      "user": "anonymous",
      "dateUpdated": "Sep 13, 2018 7:50:50 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300.0,
              "optionOpen": false
            },
            "helium": {}
          }
        },
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/sql"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "BC_ACC_NUMBER\tBC_MERCH_CODE\tBC_MERCH_CAT_DESC\tBC_MERCH_CAT_CODE\nM348934600\t30\tTransportation\t12\nM1823072687\t18\tTransportation\t12\nM50039827\t36\tHealth\t4\nM1888755466\t22\tOtherservices\t9\nM1053599405\t0\tHealth\t4\nM85975013\t45\tFood\t3\nM480139044\t34\tHealth\t4\nM692898500\t39\tHealth\t4\nM348875670\t29\tHotelservices\t6\nM151143676\t9\tBarsandrestaurants\t0\nM840466850\t42\tTech\t11\nM1741626453\t15\tSportsandtoys\t10\nM1535107174\t10\tWellnessandbeauty\t14\nM855959430\t43\tHyper\t7\nM349281107\t31\tFashion\t2\nM209847108\t27\tWellnessandbeauty\t14\nM2122776122\t28\tHome\t5\nM1873032707\t21\tHotelservices\t6\nM2011752106\t25\tHotelservices\t6\nM857378720\t44\tHotelservices\t6\nM1198415165\t2\tWellnessandbeauty\t14\nM1748431652\t16\tWellnessandbeauty\t14\nM980657600\t49\tSportsandtoys\t10\nM1352454843\t5\tHotelservices\t6\nM117188757\t1\tHome\t5\nM547558035\t37\tFashion\t2\nM17379832\t14\tSportsandtoys\t10\nM1649169323\t12\tSportsandtoys\t10\nM1946091778\t24\tWellnessandbeauty\t14\nM97925176\t48\tWellnessandbeauty\t14\nM923029380\t46\tHome\t5\nM1353266412\t6\tHotelservices\t6\nM1842530320\t19\tTech\t11\nM677738360\t38\tContents\t1\nM1313686961\t4\tContents\t1\nM732195782\t40\tTravel\t13\nM1600850729\t11\tFashion\t2\nM1872033263\t20\tHome\t5\nM3697346\t32\tLeisure\t8\nM495352832\t35\tTravel\t13\nM1400236507\t7\tHome\t5\nM1294758098\t3\tLeisure\t8\nM1913465890\t23\tHealth\t4\nM45060432\t33\tHotelservices\t6\nM78078399\t41\tWellnessandbeauty\t14\nM2080407379\t26\tTravel\t13\nM1788569036\t17\tSportsandtoys\t10\nM1416436880\t8\tTech\t11\nM933210764\t47\tSportsandtoys\t10\nM1726401631\t13\tTravel\t13\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1534361423124_1261707932",
      "id": "20180815-193023_586425323",
      "dateCreated": "Aug 15, 2018 7:30:23 PM",
      "dateStarted": "Sep 13, 2018 7:50:50 PM",
      "dateFinished": "Sep 13, 2018 7:50:52 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Spark",
      "text": "%md\n\nUp to now, we have been using JDBC to query IRIS. There are other tables on our normalized data lake such as *IRISdemo.BC_TRANSACTIONS*. This table holds\nall debit card transactions. \n\nLet\u0027s use Spark to get a dataframe with the first 100 transactions:",
      "user": "anonymous",
      "dateUpdated": "Sep 13, 2018 7:55:03 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "editorMode": "ace/mode/markdown",
        "lineNumbers": false,
        "title": true,
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eUp to now, we have been using JDBC to query IRIS. There are other tables on our normalized data lake such as \u003cem\u003eIRISdemo.BC_TRANSACTIONS\u003c/em\u003e. This table holds\u003cbr/\u003eall debit card transactions. \u003c/p\u003e\n\u003cp\u003eLet\u0026rsquo;s use Spark to get a dataframe with the first 100 transactions:\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1534361476526_25002374",
      "id": "20180815-193116_2098244034",
      "dateCreated": "Aug 15, 2018 7:31:16 PM",
      "dateStarted": "Sep 13, 2018 7:55:03 PM",
      "dateFinished": "Sep 13, 2018 7:55:03 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\n\ndf \u003d spark.read.format(\"iris\").option(\"dbtable\",\"IRISDemo.BC_TRANSACTIONS\").load().limit(100)\ndf.show()",
      "user": "anonymous",
      "dateUpdated": "Sep 13, 2018 8:02:11 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "text",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/text",
        "lineNumbers": false,
        "title": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+---+---------------+----------------+------------------------+------------------------+-----------------+-----------------+-------------------------+-------------------------+--------------------+-------------+------------+-----------------------+\n| ID|BC_TRANS_AMOUNT|BC_TRANS_SRC_ACC|BC_TRANS_SRC_ACC_NEW_BAL|BC_TRANS_SRC_ACC_OLD_BAL|BC_TRANS_IS_FRAUD|BC_TRANS_DEST_ACC|BC_TRANS_DEST_ACC_NEW_BAL|BC_TRANS_DEST_ACC_OLD_BAL|       BC_TRANS_DATE|BC_TRANS_TYPE|BC_TRANS_NUM|BC_TRANS_WHITELISTED_BY|\n+---+---------------+----------------+------------------------+------------------------+-----------------+-----------------+-------------------------+-------------------------+--------------------+-------------+------------+-----------------------+\n|  1|           4.55|               1|                 5995.45|                  6000.0|            false|                2|                 -5995.45|                  -6000.0|2018-01-01 00:00:...|      PAYMENT|           1|                      0|\n|  2|          39.68|               3|                 5960.32|                  6000.0|            false|                2|      -5955.7699999999995|                 -5995.45|2018-01-01 00:00:...|      PAYMENT|           2|                      0|\n|  3|          26.89|               5|                 5973.11|                  6000.0|            false|                4|                 -5973.11|                  -6000.0|2018-01-01 00:00:...|      PAYMENT|           3|                      0|\n|  4|          17.25|               6|                 5982.75|                  6000.0|            false|                2|      -5938.5199999999995|      -5955.7699999999995|2018-01-01 00:00:...|      PAYMENT|           4|                      0|\n|  5|          35.72|               7|                 5964.28|                  6000.0|            false|                2|       -5902.799999999999|      -5938.5199999999995|2018-01-01 00:00:...|      PAYMENT|           5|                      0|\n|  6|          25.81|               8|                 5974.19|                  6000.0|            false|                2|       -5876.989999999999|       -5902.799999999999|2018-01-01 00:00:...|      PAYMENT|           6|                      0|\n|  7|            9.1|               9|                  5990.9|                  6000.0|            false|                2|      -5867.8899999999985|       -5876.989999999999|2018-01-01 00:00:...|      PAYMENT|           7|                      0|\n|  8|          21.17|              10|                 5978.83|                  6000.0|            false|                2|       -5846.719999999998|      -5867.8899999999985|2018-01-01 00:00:...|      PAYMENT|           8|                      0|\n|  9|           32.4|              11|                  5967.6|                  6000.0|            false|                2|       -5814.319999999999|       -5846.719999999998|2018-01-01 00:00:...|      PAYMENT|           9|                      0|\n| 10|           35.4|              12|                  5964.6|                  6000.0|            false|                2|       -5778.919999999999|       -5814.319999999999|2018-01-01 00:00:...|      PAYMENT|          10|                      0|\n| 11|          14.95|              13|                 5985.05|                  6000.0|            false|                2|       -5763.969999999999|       -5778.919999999999|2018-01-01 00:00:...|      PAYMENT|          11|                      0|\n| 12|           1.51|              14|                 5998.49|                  6000.0|            false|                4|       -5971.599999999999|                 -5973.11|2018-01-01 00:00:...|      PAYMENT|          12|                      0|\n| 13|          68.79|              15|                 5931.21|                  6000.0|            false|               16|                 -5931.21|                  -6000.0|2018-01-01 00:00:...|      PAYMENT|          13|                      0|\n| 14|          20.32|              17|                 5979.68|                  6000.0|            false|                4|                 -5951.28|       -5971.599999999999|2018-01-01 00:00:...|      PAYMENT|          14|                      0|\n| 15|          13.56|              18|                 5986.44|                  6000.0|            false|                2|       -5750.409999999999|       -5763.969999999999|2018-01-01 00:00:...|      PAYMENT|          15|                      0|\n| 16|          30.19|              19|                 5969.81|                  6000.0|            false|                2|       -5720.219999999999|       -5750.409999999999|2018-01-01 00:00:...|      PAYMENT|          16|                      0|\n| 17|          17.54|              20|                 5982.46|                  6000.0|            false|                4|                 -5933.74|                 -5951.28|2018-01-01 00:00:...|      PAYMENT|          17|                      0|\n| 18|          40.69|              21|                 5959.31|                  6000.0|            false|                2|                 -5679.53|       -5720.219999999999|2018-01-01 00:00:...|      PAYMENT|          18|                      0|\n| 19|          21.21|              22|                 5978.79|                  6000.0|            false|                2|                 -5658.32|                 -5679.53|2018-01-01 00:00:...|      PAYMENT|          19|                      0|\n| 20|          10.09|              23|                 5989.91|                  6000.0|            false|                2|                 -5648.23|                 -5658.32|2018-01-01 00:00:...|      PAYMENT|          20|                      0|\n+---+---------------+----------------+------------------------+------------------------+-----------------+-----------------+-------------------------+-------------------------+--------------------+-------------+------------+-----------------------+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1534362062080_-1994685809",
      "id": "20180815-194102_349085272",
      "dateCreated": "Aug 15, 2018 7:41:02 PM",
      "dateStarted": "Sep 13, 2018 8:02:11 PM",
      "dateFinished": "Sep 13, 2018 8:02:42 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n\nBut that is not pretty... Zeppelin can help us with some magic:",
      "user": "anonymous",
      "dateUpdated": "Sep 13, 2018 8:03:05 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eBut that is not pretty\u0026hellip; Zeppelin can help us with some magic:\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1534362395936_733998242",
      "id": "20180815-194635_389054367",
      "dateCreated": "Aug 15, 2018 7:46:35 PM",
      "dateStarted": "Sep 13, 2018 8:03:05 PM",
      "dateFinished": "Sep 13, 2018 8:03:07 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\n\nz.show(df)",
      "user": "anonymous",
      "dateUpdated": "Sep 13, 2018 8:03:14 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "text",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/text"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "ID\tBC_TRANS_AMOUNT\tBC_TRANS_SRC_ACC\tBC_TRANS_SRC_ACC_NEW_BAL\tBC_TRANS_SRC_ACC_OLD_BAL\tBC_TRANS_IS_FRAUD\tBC_TRANS_DEST_ACC\tBC_TRANS_DEST_ACC_NEW_BAL\tBC_TRANS_DEST_ACC_OLD_BAL\tBC_TRANS_DATE\tBC_TRANS_TYPE\tBC_TRANS_NUM\tBC_TRANS_WHITELISTED_BY\n1\t4.55\t1\t5995.45\t6000.0\tfalse\t2\t-5995.45\t-6000.0\t2018-01-01 00:00:20.0\tPAYMENT\t1\t0\n2\t39.68\t3\t5960.32\t6000.0\tfalse\t2\t-5955.7699999999995\t-5995.45\t2018-01-01 00:00:22.0\tPAYMENT\t2\t0\n3\t26.89\t5\t5973.11\t6000.0\tfalse\t4\t-5973.11\t-6000.0\t2018-01-01 00:00:04.0\tPAYMENT\t3\t0\n4\t17.25\t6\t5982.75\t6000.0\tfalse\t2\t-5938.5199999999995\t-5955.7699999999995\t2018-01-01 00:00:08.0\tPAYMENT\t4\t0\n5\t35.72\t7\t5964.28\t6000.0\tfalse\t2\t-5902.799999999999\t-5938.5199999999995\t2018-01-01 00:00:13.0\tPAYMENT\t5\t0\n6\t25.81\t8\t5974.19\t6000.0\tfalse\t2\t-5876.989999999999\t-5902.799999999999\t2018-01-01 00:00:10.0\tPAYMENT\t6\t0\n7\t9.1\t9\t5990.9\t6000.0\tfalse\t2\t-5867.8899999999985\t-5876.989999999999\t2018-01-01 00:00:13.0\tPAYMENT\t7\t0\n8\t21.17\t10\t5978.83\t6000.0\tfalse\t2\t-5846.719999999998\t-5867.8899999999985\t2018-01-01 00:00:15.0\tPAYMENT\t8\t0\n9\t32.4\t11\t5967.6\t6000.0\tfalse\t2\t-5814.319999999999\t-5846.719999999998\t2018-01-01 00:00:05.0\tPAYMENT\t9\t0\n10\t35.4\t12\t5964.6\t6000.0\tfalse\t2\t-5778.919999999999\t-5814.319999999999\t2018-01-01 00:00:15.0\tPAYMENT\t10\t0\n11\t14.95\t13\t5985.05\t6000.0\tfalse\t2\t-5763.969999999999\t-5778.919999999999\t2018-01-01 00:00:08.0\tPAYMENT\t11\t0\n12\t1.51\t14\t5998.49\t6000.0\tfalse\t4\t-5971.599999999999\t-5973.11\t2018-01-01 00:00:22.0\tPAYMENT\t12\t0\n13\t68.79\t15\t5931.21\t6000.0\tfalse\t16\t-5931.21\t-6000.0\t2018-01-01 00:00:04.0\tPAYMENT\t13\t0\n14\t20.32\t17\t5979.68\t6000.0\tfalse\t4\t-5951.28\t-5971.599999999999\t2018-01-01 00:00:01.0\tPAYMENT\t14\t0\n15\t13.56\t18\t5986.44\t6000.0\tfalse\t2\t-5750.409999999999\t-5763.969999999999\t2018-01-01 00:00:19.0\tPAYMENT\t15\t0\n16\t30.19\t19\t5969.81\t6000.0\tfalse\t2\t-5720.219999999999\t-5750.409999999999\t2018-01-01 00:00:16.0\tPAYMENT\t16\t0\n17\t17.54\t20\t5982.46\t6000.0\tfalse\t4\t-5933.74\t-5951.28\t2018-01-01 00:00:21.0\tPAYMENT\t17\t0\n18\t40.69\t21\t5959.31\t6000.0\tfalse\t2\t-5679.53\t-5720.219999999999\t2018-01-01 00:00:20.0\tPAYMENT\t18\t0\n19\t21.21\t22\t5978.79\t6000.0\tfalse\t2\t-5658.32\t-5679.53\t2018-01-01 00:00:10.0\tPAYMENT\t19\t0\n20\t10.09\t23\t5989.91\t6000.0\tfalse\t2\t-5648.23\t-5658.32\t2018-01-01 00:00:18.0\tPAYMENT\t20\t0\n21\t19.31\t24\t5980.69\t6000.0\tfalse\t2\t-5628.919999999999\t-5648.23\t2018-01-01 00:00:04.0\tPAYMENT\t21\t0\n22\t44.22\t25\t5955.78\t6000.0\tfalse\t2\t-5584.699999999999\t-5628.919999999999\t2018-01-01 00:00:17.0\tPAYMENT\t22\t0\n23\t44.39\t26\t5955.61\t6000.0\tfalse\t2\t-5540.309999999999\t-5584.699999999999\t2018-01-01 00:00:22.0\tPAYMENT\t23\t0\n24\t30.72\t27\t5969.28\t6000.0\tfalse\t2\t-5509.589999999998\t-5540.309999999999\t2018-01-01 00:00:19.0\tPAYMENT\t24\t0\n25\t29.84\t28\t5970.16\t6000.0\tfalse\t2\t-5479.749999999998\t-5509.589999999998\t2018-01-01 00:00:01.0\tPAYMENT\t25\t0\n26\t12.1\t29\t5987.9\t6000.0\tfalse\t2\t-5467.649999999998\t-5479.749999999998\t2018-01-01 00:00:09.0\tPAYMENT\t26\t0\n27\t24.84\t30\t5975.16\t6000.0\tfalse\t2\t-5442.809999999998\t-5467.649999999998\t2018-01-01 00:00:11.0\tPAYMENT\t27\t0\n28\t16.42\t31\t5983.58\t6000.0\tfalse\t2\t-5426.389999999998\t-5442.809999999998\t2018-01-01 00:00:21.0\tPAYMENT\t28\t0\n29\t2.19\t32\t5997.81\t6000.0\tfalse\t2\t-5424.199999999998\t-5426.389999999998\t2018-01-01 00:00:20.0\tPAYMENT\t29\t0\n30\t32.27\t33\t5967.73\t6000.0\tfalse\t2\t-5391.929999999998\t-5424.199999999998\t2018-01-01 00:00:22.0\tPAYMENT\t30\t0\n31\t28.09\t34\t5971.91\t6000.0\tfalse\t2\t-5363.839999999997\t-5391.929999999998\t2018-01-01 00:00:18.0\tPAYMENT\t31\t0\n32\t16.13\t35\t5983.87\t6000.0\tfalse\t4\t-5917.61\t-5933.74\t2018-01-01 00:00:11.0\tPAYMENT\t32\t0\n33\t32.7\t36\t5967.3\t6000.0\tfalse\t2\t-5331.139999999998\t-5363.839999999997\t2018-01-01 00:00:13.0\tPAYMENT\t33\t0\n34\t25.53\t37\t5974.47\t6000.0\tfalse\t2\t-5305.609999999998\t-5331.139999999998\t2018-01-01 00:00:14.0\tPAYMENT\t34\t0\n35\t39.22\t38\t5960.78\t6000.0\tfalse\t2\t-5266.389999999998\t-5305.609999999998\t2018-01-01 00:00:15.0\tPAYMENT\t35\t0\n36\t46.14\t39\t5953.86\t6000.0\tfalse\t2\t-5220.249999999997\t-5266.389999999998\t2018-01-01 00:00:01.0\tPAYMENT\t36\t0\n37\t29.55\t40\t5970.45\t6000.0\tfalse\t2\t-5190.699999999997\t-5220.249999999997\t2018-01-01 00:00:15.0\tPAYMENT\t37\t0\n38\t36.88\t41\t5963.12\t6000.0\tfalse\t4\t-5880.73\t-5917.61\t2018-01-01 00:00:15.0\tPAYMENT\t38\t0\n39\t36.15\t42\t5963.85\t6000.0\tfalse\t2\t-5154.549999999997\t-5190.699999999997\t2018-01-01 00:00:10.0\tPAYMENT\t39\t0\n40\t2.81\t43\t5997.19\t6000.0\tfalse\t2\t-5151.739999999997\t-5154.549999999997\t2018-01-01 00:00:03.0\tPAYMENT\t40\t0\n41\t87.67\t44\t5912.33\t6000.0\tfalse\t45\t-5912.33\t-6000.0\t2018-01-01 00:00:10.0\tPAYMENT\t41\t0\n42\t11.17\t46\t5988.83\t6000.0\tfalse\t4\t-5869.5599999999995\t-5880.73\t2018-01-01 00:00:00.0\tPAYMENT\t42\t0\n43\t105.59\t47\t5894.41\t6000.0\tfalse\t48\t-5894.41\t-6000.0\t2018-01-01 00:00:08.0\tPAYMENT\t43\t0\n44\t15.25\t49\t5984.75\t6000.0\tfalse\t2\t-5136.489999999997\t-5151.739999999997\t2018-01-01 00:00:10.0\tPAYMENT\t44\t0\n45\t33.36\t50\t5966.64\t6000.0\tfalse\t2\t-5103.129999999997\t-5136.489999999997\t2018-01-01 00:00:19.0\tPAYMENT\t45\t0\n46\t32.96\t51\t5967.04\t6000.0\tfalse\t2\t-5070.169999999997\t-5103.129999999997\t2018-01-01 00:00:15.0\tPAYMENT\t46\t0\n47\t16.96\t52\t5983.04\t6000.0\tfalse\t2\t-5053.209999999997\t-5070.169999999997\t2018-01-01 00:00:04.0\tPAYMENT\t47\t0\n48\t49.91\t53\t5950.09\t6000.0\tfalse\t4\t-5819.65\t-5869.5599999999995\t2018-01-01 00:00:21.0\tPAYMENT\t48\t0\n49\t0.93\t54\t5999.07\t6000.0\tfalse\t2\t-5052.279999999997\t-5053.209999999997\t2018-01-01 00:00:04.0\tPAYMENT\t49\t0\n50\t37.71\t55\t5962.29\t6000.0\tfalse\t2\t-5014.569999999997\t-5052.279999999997\t2018-01-01 00:00:02.0\tPAYMENT\t50\t0\n51\t12.53\t56\t5987.47\t6000.0\tfalse\t4\t-5807.12\t-5819.65\t2018-01-01 00:00:23.0\tPAYMENT\t51\t0\n52\t56.97\t57\t5943.03\t6000.0\tfalse\t2\t-4957.599999999997\t-5014.569999999997\t2018-01-01 00:00:09.0\tPAYMENT\t52\t0\n53\t31.32\t58\t5968.68\t6000.0\tfalse\t2\t-4926.279999999997\t-4957.599999999997\t2018-01-01 00:00:08.0\tPAYMENT\t53\t0\n54\t21.15\t59\t5978.85\t6000.0\tfalse\t2\t-4905.129999999997\t-4926.279999999997\t2018-01-01 00:00:00.0\tPAYMENT\t54\t0\n55\t3.12\t60\t5996.88\t6000.0\tfalse\t2\t-4902.0099999999975\t-4905.129999999997\t2018-01-01 00:00:02.0\tPAYMENT\t55\t0\n56\t33.41\t61\t5966.59\t6000.0\tfalse\t2\t-4868.599999999998\t-4902.0099999999975\t2018-01-01 00:00:23.0\tPAYMENT\t56\t0\n57\t45.92\t62\t5954.08\t6000.0\tfalse\t4\t-5761.2\t-5807.12\t2018-01-01 00:00:22.0\tPAYMENT\t57\t0\n58\t36.82\t63\t5963.18\t6000.0\tfalse\t2\t-4831.779999999998\t-4868.599999999998\t2018-01-01 00:00:20.0\tPAYMENT\t58\t0\n59\t20.05\t64\t5979.95\t6000.0\tfalse\t4\t-5741.15\t-5761.2\t2018-01-01 00:00:07.0\tPAYMENT\t59\t0\n60\t43.75\t65\t5956.25\t6000.0\tfalse\t2\t-4788.029999999998\t-4831.779999999998\t2018-01-01 00:00:13.0\tPAYMENT\t60\t0\n61\t44.88\t66\t5955.12\t6000.0\tfalse\t2\t-4743.149999999998\t-4788.029999999998\t2018-01-01 00:00:19.0\tPAYMENT\t61\t0\n62\t18.45\t67\t5981.55\t6000.0\tfalse\t2\t-4724.699999999998\t-4743.149999999998\t2018-01-01 00:00:23.0\tPAYMENT\t62\t0\n63\t29.66\t68\t5970.34\t6000.0\tfalse\t2\t-4695.039999999998\t-4724.699999999998\t2018-01-01 00:00:16.0\tPAYMENT\t63\t0\n64\t28.38\t69\t5971.62\t6000.0\tfalse\t2\t-4666.659999999998\t-4695.039999999998\t2018-01-01 00:00:16.0\tPAYMENT\t64\t0\n65\t62.76\t70\t5937.24\t6000.0\tfalse\t2\t-4603.899999999998\t-4666.659999999998\t2018-01-01 00:00:06.0\tPAYMENT\t65\t0\n66\t21.6\t71\t5978.4\t6000.0\tfalse\t2\t-4582.299999999997\t-4603.899999999998\t2018-01-01 00:00:17.0\tPAYMENT\t66\t0\n67\t30.74\t72\t5969.26\t6000.0\tfalse\t2\t-4551.559999999998\t-4582.299999999997\t2018-01-01 00:00:22.0\tPAYMENT\t67\t0\n68\t58.33\t73\t5941.67\t6000.0\tfalse\t2\t-4493.229999999998\t-4551.559999999998\t2018-01-01 00:00:18.0\tPAYMENT\t68\t0\n69\t44.07\t74\t5955.93\t6000.0\tfalse\t2\t-4449.159999999998\t-4493.229999999998\t2018-01-01 00:00:22.0\tPAYMENT\t69\t0\n70\t6.52\t75\t5993.48\t6000.0\tfalse\t2\t-4442.639999999998\t-4449.159999999998\t2018-01-01 00:00:02.0\tPAYMENT\t70\t0\n71\t2.96\t76\t5997.04\t6000.0\tfalse\t4\t-5738.19\t-5741.15\t2018-01-01 00:00:14.0\tPAYMENT\t71\t0\n72\t44.69\t77\t5955.31\t6000.0\tfalse\t2\t-4397.949999999998\t-4442.639999999998\t2018-01-01 00:00:17.0\tPAYMENT\t72\t0\n73\t5.01\t78\t5994.99\t6000.0\tfalse\t4\t-5733.179999999999\t-5738.19\t2018-01-01 00:00:18.0\tPAYMENT\t73\t0\n74\t9.74\t79\t5990.26\t6000.0\tfalse\t2\t-4388.209999999998\t-4397.949999999998\t2018-01-01 00:00:11.0\tPAYMENT\t74\t0\n75\t10.1\t80\t5989.9\t6000.0\tfalse\t2\t-4378.109999999998\t-4388.209999999998\t2018-01-01 00:00:05.0\tPAYMENT\t75\t0\n76\t58.64\t81\t5941.36\t6000.0\tfalse\t2\t-4319.4699999999975\t-4378.109999999998\t2018-01-01 00:00:12.0\tPAYMENT\t76\t0\n77\t29.2\t82\t5970.8\t6000.0\tfalse\t2\t-4290.269999999998\t-4319.4699999999975\t2018-01-01 00:00:06.0\tPAYMENT\t77\t0\n78\t32.6\t83\t5967.4\t6000.0\tfalse\t84\t-5967.4\t-6000.0\t2018-01-01 00:00:18.0\tPAYMENT\t78\t0\n79\t52.35\t85\t5947.65\t6000.0\tfalse\t2\t-4237.919999999997\t-4290.269999999998\t2018-01-01 00:00:19.0\tPAYMENT\t79\t0\n80\t159.92\t86\t5840.08\t6000.0\tfalse\t48\t-5734.49\t-5894.41\t2018-01-01 00:00:04.0\tPAYMENT\t80\t0\n81\t26.37\t87\t5973.63\t6000.0\tfalse\t2\t-4211.549999999997\t-4237.919999999997\t2018-01-01 00:00:22.0\tPAYMENT\t81\t0\n82\t49.07\t88\t5950.93\t6000.0\tfalse\t2\t-4162.479999999998\t-4211.549999999997\t2018-01-01 00:00:21.0\tPAYMENT\t82\t0\n83\t35.74\t89\t5964.26\t6000.0\tfalse\t2\t-4126.739999999998\t-4162.479999999998\t2018-01-01 00:00:00.0\tPAYMENT\t83\t0\n84\t47.53\t90\t5952.47\t6000.0\tfalse\t4\t-5685.65\t-5733.179999999999\t2018-01-01 00:00:02.0\tPAYMENT\t84\t0\n85\t29.87\t91\t5970.13\t6000.0\tfalse\t2\t-4096.869999999998\t-4126.739999999998\t2018-01-01 00:00:20.0\tPAYMENT\t85\t0\n86\t20.31\t92\t5979.69\t6000.0\tfalse\t2\t-4076.559999999998\t-4096.869999999998\t2018-01-01 00:00:21.0\tPAYMENT\t86\t0\n87\t10.59\t93\t5989.41\t6000.0\tfalse\t2\t-4065.969999999998\t-4076.559999999998\t2018-01-01 00:00:22.0\tPAYMENT\t87\t0\n88\t21.92\t94\t5978.08\t6000.0\tfalse\t2\t-4044.049999999998\t-4065.969999999998\t2018-01-01 00:00:03.0\tPAYMENT\t88\t0\n89\t44.26\t96\t5955.74\t6000.0\ttrue\t95\t-5955.74\t-6000.0\t2018-01-01 00:00:18.0\tPAYMENT\t89\t0\n90\t324.5\t97\t5675.5\t6000.0\ttrue\t95\t-5631.24\t-5955.74\t2018-01-01 00:00:15.0\tPAYMENT\t90\t0\n91\t26.07\t98\t5973.93\t6000.0\tfalse\t4\t-5659.58\t-5685.65\t2018-01-01 00:00:08.0\tPAYMENT\t91\t0\n92\t10.88\t99\t5989.12\t6000.0\tfalse\t2\t-4033.169999999998\t-4044.049999999998\t2018-01-01 00:00:12.0\tPAYMENT\t92\t0\n93\t8.05\t100\t5991.95\t6000.0\tfalse\t2\t-4025.1199999999976\t-4033.169999999998\t2018-01-01 00:00:22.0\tPAYMENT\t93\t0\n94\t25.59\t101\t5974.41\t6000.0\tfalse\t2\t-3999.5299999999975\t-4025.1199999999976\t2018-01-01 00:00:02.0\tPAYMENT\t94\t0\n95\t15.26\t102\t5984.74\t6000.0\tfalse\t2\t-3984.2699999999973\t-3999.5299999999975\t2018-01-01 00:00:13.0\tPAYMENT\t95\t0\n96\t20.73\t103\t5979.27\t6000.0\tfalse\t2\t-3963.5399999999972\t-3984.2699999999973\t2018-01-01 00:00:14.0\tPAYMENT\t96\t0\n97\t68.17\t104\t5931.83\t6000.0\tfalse\t2\t-3895.369999999997\t-3963.5399999999972\t2018-01-01 00:00:19.0\tPAYMENT\t97\t0\n98\t34.75\t105\t5965.25\t6000.0\tfalse\t2\t-3860.619999999997\t-3895.369999999997\t2018-01-01 00:00:16.0\tPAYMENT\t98\t0\n99\t171.07\t106\t5828.93\t6000.0\tfalse\t107\t-5828.93\t-6000.0\t2018-01-01 00:00:14.0\tPAYMENT\t99\t0\n100\t50.31\t108\t5949.69\t6000.0\tfalse\t2\t-3810.309999999997\t-3860.619999999997\t2018-01-01 00:00:09.0\tPAYMENT\t100\t0\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1534362382372_706311122",
      "id": "20180815-194622_1956120964",
      "dateCreated": "Aug 15, 2018 7:46:22 PM",
      "dateStarted": "Sep 13, 2018 8:03:14 PM",
      "dateFinished": "Sep 13, 2018 8:03:15 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Scala",
      "text": "%md\n\nWe have been using %irisjdbc and %spark.pyspark to use JDBC and Python with Spark. We can also don\u0027t use any % magic and use Scala, the default language of this notebook:",
      "user": "anonymous",
      "dateUpdated": "Sep 13, 2018 8:04:50 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false,
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eWe have been using %irisjdbc and %spark.pyspark to use JDBC and Python with Spark. We can also don\u0026rsquo;t use any % magic and use Scala, the default language of this notebook:\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1534362278012_607076554",
      "id": "20180815-194438_2031050104",
      "dateCreated": "Aug 15, 2018 7:44:38 PM",
      "dateStarted": "Sep 13, 2018 8:04:50 PM",
      "dateFinished": "Sep 13, 2018 8:04:50 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "val df \u003d spark.read.format(\"iris\").option(\"dbtable\",\"IRISDemo.BC_TRANSACTIONS\").load().limit(10)\nz.show(df)",
      "user": "anonymous",
      "dateUpdated": "Sep 13, 2018 8:04:57 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "text",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/text"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "df: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] \u003d [ID: bigint, BC_TRANS_AMOUNT: double ... 11 more fields]\n"
          },
          {
            "type": "TABLE",
            "data": "ID\tBC_TRANS_AMOUNT\tBC_TRANS_SRC_ACC\tBC_TRANS_SRC_ACC_NEW_BAL\tBC_TRANS_SRC_ACC_OLD_BAL\tBC_TRANS_IS_FRAUD\tBC_TRANS_DEST_ACC\tBC_TRANS_DEST_ACC_NEW_BAL\tBC_TRANS_DEST_ACC_OLD_BAL\tBC_TRANS_DATE\tBC_TRANS_TYPE\tBC_TRANS_NUM\tBC_TRANS_WHITELISTED_BY\n1\t4.55\t1\t5995.45\t6000.0\tfalse\t2\t-5995.45\t-6000.0\t2018-01-01 00:00:20.0\tPAYMENT\t1\t0\n2\t39.68\t3\t5960.32\t6000.0\tfalse\t2\t-5955.7699999999995\t-5995.45\t2018-01-01 00:00:22.0\tPAYMENT\t2\t0\n3\t26.89\t5\t5973.11\t6000.0\tfalse\t4\t-5973.11\t-6000.0\t2018-01-01 00:00:04.0\tPAYMENT\t3\t0\n4\t17.25\t6\t5982.75\t6000.0\tfalse\t2\t-5938.5199999999995\t-5955.7699999999995\t2018-01-01 00:00:08.0\tPAYMENT\t4\t0\n5\t35.72\t7\t5964.28\t6000.0\tfalse\t2\t-5902.799999999999\t-5938.5199999999995\t2018-01-01 00:00:13.0\tPAYMENT\t5\t0\n6\t25.81\t8\t5974.19\t6000.0\tfalse\t2\t-5876.989999999999\t-5902.799999999999\t2018-01-01 00:00:10.0\tPAYMENT\t6\t0\n7\t9.1\t9\t5990.9\t6000.0\tfalse\t2\t-5867.8899999999985\t-5876.989999999999\t2018-01-01 00:00:13.0\tPAYMENT\t7\t0\n8\t21.17\t10\t5978.83\t6000.0\tfalse\t2\t-5846.719999999998\t-5867.8899999999985\t2018-01-01 00:00:15.0\tPAYMENT\t8\t0\n9\t32.4\t11\t5967.6\t6000.0\tfalse\t2\t-5814.319999999999\t-5846.719999999998\t2018-01-01 00:00:05.0\tPAYMENT\t9\t0\n10\t35.4\t12\t5964.6\t6000.0\tfalse\t2\t-5778.919999999999\t-5814.319999999999\t2018-01-01 00:00:15.0\tPAYMENT\t10\t0\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1534361495104_737218561",
      "id": "20180815-193135_914958050",
      "dateCreated": "Aug 15, 2018 7:31:35 PM",
      "dateStarted": "Sep 13, 2018 8:04:57 PM",
      "dateFinished": "Sep 13, 2018 8:04:58 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "Now, let\u0027s load our data and create some features. We will be working with python and spark:",
      "user": "anonymous",
      "dateUpdated": "Aug 15, 2018 7:50:41 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala"
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1534362445683_-1212385147",
      "id": "20180815-194725_339642473",
      "dateCreated": "Aug 15, 2018 7:47:25 PM",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\n\ndf \u003d spark.read.format(\"iris\").option(\"dbtable\",\"IRISDemo.BC_TRANSACTIONS\")\n\ndf \u003d df.withColumnRenamed(\"\")",
      "user": "anonymous",
      "dateUpdated": "Aug 15, 2018 7:52:16 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python"
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1534362625674_-889487230",
      "id": "20180815-195025_747510009",
      "dateCreated": "Aug 15, 2018 7:50:25 PM",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%irisjdbc\n\nselect t.BC_TRANS_SRC_ACC, AVG(t.BC_TRANS_AMOUNT) AMOUNT_AVG, STDDEV(t.BC_TRANS_AMOUNT) AMOUNT_STDDEV\nfrom IRISDemo.BC_TRANSACTIONS t, \nIRISDemo.CS_FRAUD_COMPLAINT c \nwhere t.ID*\u003dc.CS_FRAUD_COMP_TRANSACTION AND\nt.BC_TRANS_TYPE\u003d\u0027PAYMENT\u0027 AND\n(c.CS_FRAUD_COMP_CONFIRMED is null OR c.CS_FRAUD_COMP_CONFIRMED\u003c\u003e1)\ngroup by t.BC_TRANS_SRC_ACC\nhaving STDDEV(t.BC_TRANS_AMOUNT)\u003e0",
      "user": "anonymous",
      "dateUpdated": "Aug 13, 2018 6:17:50 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/sql"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "BC_TRANS_SRC_ACC\tAMOUNT_AVG\tAMOUNT_STDDEV\n122\t19.916666666666668\t9.471062946329385\n163\t41.43\t20.025264043203034\n299\t36.129999999999995\t7.254915574974014\n415\t22.43\t22.69812767608817\n506\t24.240000000000002\t30.60358148975378\n583\t12.115\t13.781511165325812\n591\t14.065\t16.143247814488884\n634\t21.55\t6.533666658163692\n692\t22.97\t17.73054144689327\n734\t53.435\t12.69256672229848\n794\t22.49\t13.406744571296942\n1020\t22.87\t27.94485999249236\n1110\t59.68\t17.69181166528743\n1228\t9.815\t10.92479976933216\n1445\t42.17\t31.79152088214718\n1451\t18.45\t10.224764055957483\n1617\t18.945\t19.905055890401318\n2062\t20.6\t11.808683245815336\n2081\t24.595\t10.684383463728736\n2116\t82.78\t102.03550852521882\n2148\t30.735\t7.191275964667184\n2407\t21.78\t7.5094740162011195\n2551\t57.205\t48.21761140911067\n2580\t14.9\t10.988439379638953\n2747\t35.114999999999995\t12.070312754854385\n2800\t31.325000000000003\t17.45846642749586\n2805\t20.84\t23.57494008475949\n2815\t45.95\t2.5738686835189544\n3091\t24.38\t3.662813126546332\n3319\t30.955\t2.5950818869546586\n3431\t24.205\t21.82838633522873\n3984\t16.665\t6.0174787078975305\n4074\t41.349999999999994\t4.5113412639702535\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1534173682854_1798463942",
      "id": "20180813-152122_1423404779",
      "dateCreated": "Aug 13, 2018 3:21:22 PM",
      "dateStarted": "Aug 13, 2018 6:17:50 PM",
      "dateFinished": "Aug 13, 2018 6:17:53 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "As can be seen, every client is different. Let\u0027s take one client that has a high standard deviation. The client with account number 2116 looks interesting.",
      "user": "anonymous",
      "dateUpdated": "Aug 13, 2018 6:18:39 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1534174215411_-1226481172",
      "id": "20180813-153015_1547322255",
      "dateCreated": "Aug 13, 2018 3:30:15 PM",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%irisjdbc\nselect ID, BC_TRANS_AMOUNT, BC_TRANS_DEST_ACC, BC_TRANS_WHITELISTED_BY from IRISDemo.BC_TRANSACTIONS t where t.BC_TRANS_SRC_ACC \u003d2116 \n",
      "user": "anonymous",
      "dateUpdated": "Aug 13, 2018 6:22:11 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {
          "0": {
            "graph": {
              "mode": "lineChart",
              "height": 300.0,
              "optionOpen": true,
              "setting": {
                "stackedAreaChart": {
                  "style": "stack"
                },
                "scatterChart": {
                  "xAxis": {
                    "name": "ID",
                    "index": 0.0,
                    "aggr": "sum"
                  },
                  "yAxis": {
                    "name": "BC_TRANS_AMOUNT",
                    "index": 1.0,
                    "aggr": "sum"
                  },
                  "group": {
                    "name": "BC_TRANS_DEST_ACC",
                    "index": 2.0,
                    "aggr": "sum"
                  }
                }
              },
              "keys": [
                {
                  "name": "ID",
                  "index": 0.0,
                  "aggr": "sum"
                }
              ],
              "groups": [
                {
                  "name": "BC_TRANS_DEST_ACC",
                  "index": 2.0,
                  "aggr": "sum"
                }
              ],
              "values": [
                {
                  "name": "BC_TRANS_AMOUNT",
                  "index": 1.0,
                  "aggr": "sum"
                }
              ]
            },
            "helium": {}
          }
        },
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/sql"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "ID\tBC_TRANS_AMOUNT\tBC_TRANS_DEST_ACC\tBC_TRANS_WHITELISTED_BY\n2095\t7.1\t2\tnull\n3737\t29.58\t222\tnull\n6038\t47.09\t2\tnull\n11485\t36.04\t2\tnull\n13133\t22.26\t2\tnull\n19634\t35.14\t2\tnull\n21455\t3.29\t2\tnull\n23818\t10.02\t141\tnull\n25558\t46.47\t2\tnull\n29626\t29.53\t2\tnull\n40417\t42.53\t2\tnull\n43639\t71.05\t2\tnull\n46061\t2.63\t2\tnull\n47558\t34.55\t2\tnull\n51660\t28.16\t2\tnull\n53272\t25.26\t2\tnull\n57128\t64.03\t2\tnull\n58265\t13.19\t2\tnull\n62418\t31.69\t2\tnull\n65031\t50.41\t2\tnull\n70299\t17.04\t2\tnull\n74015\t8.79\t2\tnull\n81950\t28.83\t2\tnull\n85347\t34.82\t2\tnull\n87656\t6.23\t2\tnull\n90595\t23.54\t2\tnull\n93456\t16.9\t2\tnull\n95476\t33.82\t2\tnull\n99108\t8.35\t2\tnull\n101177\t21.72\t2\tnull\n106719\t18.55\t2\tnull\n109069\t6.93\t222\tnull\n110849\t2.78\t2\tnull\n115746\t24.51\t2\tnull\n121849\t19.54\t2\tnull\n125556\t18.8\t2\tnull\n131093\t20.08\t2\tnull\n132017\t17.85\t2\tnull\n136553\t27.61\t2\tnull\n138009\t21.26\t2\tnull\n142095\t34.48\t2\tnull\n145510\t25.74\t2\tnull\n149312\t3.32\t2\tnull\n152043\t44.41\t2\tnull\n156137\t20.76\t2\tnull\n157908\t2.77\t2\tnull\n167637\t18.56\t2\tnull\n171514\t49.47\t2\tnull\n174321\t59.32\t2\tnull\n177769\t12.19\t2\tnull\n180907\t3.22\t2\tnull\n184177\t24.13\t2\tnull\n189380\t55.41\t2\tnull\n198649\t29.56\t2\tnull\n202189\t4.34\t2\tnull\n206564\t7.58\t2\tnull\n207162\t25.43\t2\tnull\n212590\t43.6\t2\tnull\n215466\t4.01\t2\tnull\n217457\t23.11\t2\tnull\n222430\t75.47\t2\tnull\n226082\t14.84\t2\tnull\n227294\t43.54\t2\tnull\n230941\t53.09\t2\tnull\n234221\t27.32\t2\tnull\n237894\t33.83\t2\tnull\n241092\t15.64\t2\tnull\n244572\t3.59\t2\tnull\n248161\t14.79\t2\tnull\n255585\t34.19\t2\tnull\n259300\t5.84\t2\tnull\n261345\t27.87\t713\tnull\n263900\t24.96\t2\tnull\n268745\t22.94\t2\tnull\n273455\t9.01\t2\tnull\n276415\t34.9\t269\tnull\n279651\t55.49\t2\tnull\n286570\t11.24\t2\tnull\n288632\t25.42\t2\tnull\n292608\t21.55\t2\tnull\n296243\t18.01\t2\tnull\n300811\t38.23\t2\tnull\n302192\t25.06\t2\tnull\n306593\t23.12\t2\tnull\n310776\t42.85\t2\tnull\n312092\t2.54\t2\tnull\n317813\t50.92\t2\tnull\n319671\t24.47\t2\tnull\n324342\t30.95\t2\tnull\n331328\t26.64\t2\tnull\n334066\t15.2\t2\tnull\n336173\t38.64\t2\tnull\n345144\t64.24\t2\tnull\n349304\t3.54\t2\tnull\n353506\t1.95\t2\tnull\n354861\t30.71\t2\tnull\n358409\t13.87\t2\tnull\n362669\t51.84\t2\tnull\n366332\t20.73\t2\tnull\n368282\t54.33\t2\tnull\n371874\t9.97\t2\tnull\n378290\t93.0\t1138\tnull\n379328\t9.59\t2\tnull\n379329\t15.9\t4\tnull\n384537\t41.53\t4\tnull\n387305\t10.39\t4\tnull\n394378\t16.25\t4\tnull\n397133\t3.22\t4\tnull\n399916\t154.93\t48\tnull\n406742\t1.45\t4\tnull\n409891\t19.55\t4\tnull\n412889\t26.04\t84\tnull\n417254\t9.22\t4\tnull\n420925\t36.23\t4\tnull\n424502\t6.1\t4\tnull\n430904\t19.65\t4\tnull\n433779\t17.01\t4\tnull\n438496\t40.86\t4\tnull\n441967\t62.18\t4\tnull\n446763\t11.43\t4\tnull\n447498\t6.91\t4\tnull\n451133\t18.24\t4\tnull\n454279\t0.91\t4\tnull\n461231\t66.18\t4\tnull\n464298\t52.87\t4\tnull\n465529\t33.96\t4\tnull\n471638\t19.58\t4\tnull\n472928\t4.28\t4\tnull\n479062\t28.25\t4\tnull\n481194\t50.99\t84\tnull\n483620\t10.63\t4\tnull\n489199\t7.44\t4\tnull\n492062\t85.67\t4\tnull\n495985\t18.48\t4\tnull\n498761\t3.11\t4\tnull\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1534173744308_-326980927",
      "id": "20180813-152224_1297834506",
      "dateCreated": "Aug 13, 2018 3:22:24 PM",
      "dateStarted": "Aug 13, 2018 6:21:01 PM",
      "dateFinished": "Aug 13, 2018 6:21:01 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "As can be seen, this client has a profile of transactions that he/she does frequently. \nThere are some transactions though that are clearly not part of his/her profile, with\na very high value and to an unusual merchant. Let\u0027s take a look at transaction number 463295. \nThis specific transaction is of US$ 552. The standard deviation for this customer is of 85 with\nan average amount of transaction of 92.\n\n(649-92)/85 \u003d 6/55\n\nSo, this transaction is 6.55 times the standard deviation for this customer!\n\nLet\u0027s see if it was marked as fraudulent by a confirmed complaint:\n",
      "user": "anonymous",
      "dateUpdated": "Aug 13, 2018 5:05:52 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": false,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1534174735392_1028695240",
      "id": "20180813-153855_1608372894",
      "dateCreated": "Aug 13, 2018 3:38:55 PM",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%irisjdbc\n\nselect m.BC_MERCH_CATEGORY-\u003eBC_MERCH_CAT_DESC, AVG(t.BC_TRANS_AMOUNT), STDDEV(t.BC_TRANS_AMOUNT)\n\nfrom \n    IRISDemo.BC_TRANSACTIONS t, \n    IRISDemo.BC_MERCH_ACCOUNT m\n\nwhere \nt.BC_TRANS_IS_FRAUD\u003d1 and\nt.BC_TRANS_DEST_ACC\u003dm.ID\n\ngroup by \nm.BC_MERCH_CATEGORY-\u003eBC_MERCH_CAT_DESC",
      "user": "anonymous",
      "dateUpdated": "Aug 13, 2018 6:51:11 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/sql"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "BC_MERCH_CAT_DESC\tAggregate_2\tAggregate_3\nBARSANDRESTAURANTS\t157.71916666666667\t126.40487409545453\nFASHION\t248.72642857142878\t174.0403118799728\nHEALTH\t409.92053030303015\t299.072903082675\nHOME\t462.92386861313855\t323.0092050157489\nHOTELSERVICES\t423.78108225108224\t288.6640915933239\nHYPER\t174.6849159663865\t114.12702603094513\nLEISURE\t300.7655825242718\t85.32337694292599\nOTHERSERVICES\t312.0390625\t212.79434329999887\nSPORTSANDTOYS\t348.599867205542\t239.12368524731428\nTECH\t414.9075384615383\t279.94796111398716\nTRAVEL\t2692.3220517928276\t1734.006744643929\nWELLNESSANDBEAUTY\t230.27716216216228\t165.04196237694327\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1534185601314_1152016426",
      "id": "20180813-184001_933769216",
      "dateCreated": "Aug 13, 2018 6:40:01 PM",
      "dateStarted": "Aug 13, 2018 6:51:12 PM",
      "dateFinished": "Aug 13, 2018 6:51:12 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%irisjdbc\n\nselect m.BC_MERCH_CATEGORY-\u003eBC_MERCH_CAT_DESC, BC_TRANS_DEST_ACC, AVG(BC_TRANS_AMOUNT) \n\nfrom \n    IRISDemo.BC_TRANSACTIONS t, \n    IRISDemo.BC_MERCH_ACCOUNT m\n\nwhere \nt.BC_TRANS_IS_FRAUD\u003d1\n\ngroup by \nm.BC_MERCH_CATEGORY-\u003eBC_MERCH_CAT_DESC,\nBC_TRANS_DEST_ACC\n",
      "user": "anonymous",
      "dateUpdated": "Aug 13, 2018 6:40:01 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/sql"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "BC_TRANS_IS_FRAUD\tBC_TRANS_WHITELISTED_BY\n0\t813\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1534175062722_-1366875650",
      "id": "20180813-154422_2143347115",
      "dateCreated": "Aug 13, 2018 3:44:22 PM",
      "dateStarted": "Aug 13, 2018 5:06:55 PM",
      "dateFinished": "Aug 13, 2018 5:06:55 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "So, the client white listed this transaction before doing it! It is not a fraud. \nIf we could store on our normalized data lake statistics about our customers such as the average value of his/her transactions\nand the standard deviation of the value, of all transactions that are not frauds, we could very quickly\nknow if a transaction is out of pattern or not! \n\nIt would take the transactional system a lot of work to do this and that would impact its transactional performance.\nBut our normalized datatalake is separate and is being kept up to date asynchronously by the transactional services layer.",
      "user": "anonymous",
      "dateUpdated": "Aug 13, 2018 6:08:48 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1534175189930_-1936503236",
      "id": "20180813-154629_1904192762",
      "dateCreated": "Aug 13, 2018 3:46:29 PM",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%irisjdbc\n\nselect * from IRISDemo.BC_TRANSACTIONS where BC_TRANS_IS_FRAUD\u003d1",
      "user": "anonymous",
      "dateUpdated": "Aug 13, 2018 6:10:10 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/sql"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "ID\tBC_TRANS_AMOUNT\tBC_TRANS_SRC_ACC\tBC_TRANS_SRC_ACC_NEW_BAL\tBC_TRANS_SRC_ACC_OLD_BAL\tBC_TRANS_IS_FRAUD\tBC_TRANS_DEST_ACC\tBC_TRANS_DEST_ACC_NEW_BAL\tBC_TRANS_DEST_ACC_OLD_BAL\tBC_TRANS_DATE\tBC_TRANS_TYPE\tBC_TRANS_WHITELISTED_BY\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1534183757700_331896525",
      "id": "20180813-180917_654200803",
      "dateCreated": "Aug 13, 2018 6:09:17 PM",
      "dateStarted": "Aug 13, 2018 6:09:42 PM",
      "dateFinished": "Aug 13, 2018 6:09:42 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%irisjdbc\n\nselect t.*\nfrom IRISDemo.BC_TRANSACTIONS t \nwhere t.BC_TRANS_SRC_ACC \u003d78 and \n((t.BC_TRANS_AMOUNT - ?)/?) \u003e 2\n",
      "user": "anonymous",
      "dateUpdated": "Aug 13, 2018 6:09:35 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/sql"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1534174406109_-854689497",
      "id": "20180813-153326_556270505",
      "dateCreated": "Aug 13, 2018 3:33:26 PM",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "~Trash/IRIS Demo",
  "id": "2DQECRZ15",
  "angularObjects": {},
  "config": {},
  "info": {}
}